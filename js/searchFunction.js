var products = [

    {
        id: '1',
        image: '../access/img/img_1.webp',
        name: 'Peruvian Organic Raw Cacao Butter (250g)',
        price: '£7.49',
        category: 'BRANDS'
    },
    {
        id: '2',
        image: '../access/img/img_1.webp',
        name: 'Peruvian Organic Raw Cacao Butter (250g)',
        price: '£7.49',
        category: 'BRANDS'
    },
    {
        id: '3',
        image: '../access/img/img_1.webp',
        name: 'Peruvian Organic Raw Cacao Butter (250g)',
        price: '£7.49',
        category: 'Consious Chocolate'
    },
    {
        id: '4',
        image: '../access/img/img_1.webp',
        name: 'Peruvian Organic Raw Cacao Butter (250g)',
        price: '£7.49',
        category: 'Element for life'
    },
    {
        id: '5',
        image: '../access/img/img_1.webp',
        name: 'Peruvian Organic Raw Cacao Butter (250g)',
        price: '£7.49',
        category: 'Enjoy'
    },
    {
        id: '6',
        image: '../access/img/img_1.webp',
        name: 'Peruvian Organic Raw Cacao Butter (250g)',
        price: '£7.49',
        category: 'Forever Cacao'
    },
    {
        id: '7',
        image: '../access/img/img_1.webp',
        name: 'Peruvian Organic Raw Cacao Butter (250g)',
        price: '£7.49',
        category: 'Ombar'
    },
    {
        id: '8',
        image: '../access/img/list-img-1.webp',
        name: 'Conscious Citrus Zest',
        weight: '60g',
        price: '£2.99',
        category: 'Ombar'
    },
    {
        id: '9',
        image: '../access/img/list-img-2.webp',
        name: 'Conscious Dark Side 85%',
        weight: '60g',
        price: 'Sold out',
        category: 'Forever Cacao'
    },
    {
        id: '10',
        image: '../access/img/list-img-3.webp',
        name: 'Conscious Four Nuts',
        weight: '60g',
        price: '£2.99',
        category: 'Element for life'
    },
    {
        id: '11',
        image: '../access/img/list-img-4.webp',
        name: 'Conscious Goji and Coconut',
        weight: '60g',
        price: '£2.99',
        category: 'Enjoy'
    },
    {
        id: '12',
        image: '../access/img/list-img-5.webp',
        name: 'Conscious Love Potion No.9',
        weight: '60g',
        price: '£2.99',
        category: 'Consious Chocolate'
    },
    {
        id: '13',
        image: '../access/img/list-img-6.webp',
        name: 'Conscious Maca & Sprirulina',
        weight: '60g',
        price: '£2.99',
        category: 'BRANDS'
    },
    {
        id: '14',
        image: '../access/img/list-img-7.webp',
        name: 'Conscious Orange & Tanregine',
        weight: '60g',
        price: '£2.99',
        category: 'BRANDS'
    },
    {
        id: '15',
        image: '../access/img/list-img-8.webp',
        name: 'Coracao 81% Cacao Bar',
        weight: '(2oz/57g)',
        price: 'Sold out',
        category: 'Consious Chocolate'

    },
    {
        id: '16',
        image: '../access/img/list-img-9.avif',
        name: 'Coracao After Dark Bar',
        weight: '(2oz/57g)',
        price: 'Sold out',
        category: 'Consious Chocolate'
    },
    {
        id: '17',
        image: '../access/img/list-img-10.webp',
        name: 'Coracao Berkeley Bar',
        weight: '(2.5oz/70g)',
        price: 'Sold out',
        category: 'Element for life'
    },
    {
        id: '18',
        image: '../access/img/list-img-11.webp',
        name: 'Coracao Caramel Bar',
        weight: '(2.5oz/70g)',
        price: 'Sold out',
        category: 'Enjoy'
    },
    {
        id: '19',
        image: '../access/img/list-img-12.webp',
        name: 'Coracao Hazelnut Cream Bar',
        weight: '(2oz/56g)',
        price: 'Sold out',
        category: 'Enjoy'
    },
    {
        id: '20',
        image: '../access/img/list-img-13.webp',
        name: 'Yummy Scrummy Raw Chocolate Brownie',
        price: 'from £2.99',
        category: 'Enjoy'
    },
    {
        id: '21',

        image: '../access/img/list-img-14.webp',
        name: 'Enjoy! Coconut Milk',
        weight: '(70g)',
        price: 'from £2.99',
        category: 'BRANDS'
    },
    {
        id: '22',

        image: '../access/img/list-img-13.webp',
        name: 'Yummy Scrummy Raw Chocolate Brownie',
        weight: ' ',
        price: 'from £2.99',
        category: 'BRANDS'
    },
    {
        id: '23',

        image: '../access/img/list-img-14.webp',
        name: 'Enjoy! Daringly Darkest 85%',
        weight: '(70g)',
        price: 'from £2.99',
        category: 'BRANDS'
    },
    {
        id: '24',

        image: '../access/img/list-img-15.webp',
        name: 'Enjoy! Delightfully Dark 70% (70g)',
        weight: ' ',
        price: 'from £2.99',
        category: 'Consious Chocolate'
    },
    {
        id: '25',

        image: '../access/img/list-img-16.webp',
        name: 'Enjoy! Delightfully Dark 70%',
        weight: 'Button (96g)',
        price: 'from £2.99',
        category: 'Consious Chocolate'
    },
    {
        id: '26',

        image: '../access/img/list-img-17.webp',
        name: 'Enjoy! Magical Mint',
        weight: 'Button (96g)',
        price: 'from £2.99',
        category: 'Consious Chocolate'
    },
    {
        id: '27',

        image: '../access/img/list-img-18.webp',
        name: 'Enjoy! Mint',
        weight: '(70g)',
        price: 'from £2.99',
        category: 'BRANDS'
    },
    {
        id: '28',

        image: '../access/img/list-img-19.webp',
        name: 'Forever Cacao: Bean to Bar 100%)',
        weight: ' ',
        price: 'from £3.99',
        category: 'BRANDS'
    },
    {
        id: '29',

        image: '../access/img/list-img-19.webp',
        name: 'Forever Cacao: Bean to Bar 55%',
        weight: ' ',
        price: 'from £3.99',
        category: 'BRANDS'
    },
    {
        id: '30',

        image: '../access/img/list-img-19.webp',
        name: 'Forever Cacao: Bean to Bar 65%',
        weight: ' ',
        price: 'from £3.99',
        category: 'Enjoy'
    },
    {
        id: '31',
        image: '../access/img/list-img-19.webp',
        name: 'Forever Cacao: Bean to Bar 75%',
        weight: ' ',
        price: 'from £3.99',
        category: 'Enjoy'
    },
    {
        id: '32',
        image: '../access/img/list-img-20.webp',
        name: 'Ombar 100% Organic Chocolate ',
        weight: '(35g)',
        price: 'from £3.99',
        category: 'Enjoy'
    },
    {
        id: '33',
        image: '../access/img/list-img-21.webp',
        name: 'Ombar 72% Organic Chocolate ',
        weight: '(35g)',
        price: 'Sold out',
        category: 'Element for life'
    },
    {
        id: '34',
        image: '../access/img/list-img-21.webp',
        name: 'Ombar 100% Organic Chocolate ',
        weight: '(70g)',
        price: 'Sold out',
        category: 'Element for life'
    },
    {
        id: '35',
        image: '../access/img/list-img-22.webp',
        name: 'Ombar Blueberry & Acai Organic Chocolate',
        weight: '(35g)',
        price: 'from £1.99',
        category: 'Element for life'
    }
]
if (localStorage.getItem("products") == null) {
    products = localStorage.setItem("products", JSON.stringify(products));
}
window.onload = addCategory();
window.onload = addKeyBoardSearch();
window.onload = showListCategory();
window.onload = addHideListSearch();
function addKeyBoardSearch() {
    let searchKeyboard = document.getElementById("searchInput");
    searchKeyboard.addEventListener("keypress", function (event) {
        if (event.key === "Enter") {
            event.preventDefault();
            let category = document.getElementById("categoryList").value;
            let minPrice = document.getElementById("minRange").value;
            let maxPrice = document.getElementById("maxRange").value;
            localStorage.setItem("findProduct", JSON.stringify(controllerFindProduct(searchKeyboard.value, category, minPrice, maxPrice)));
            window.location = "search.html"
        }
    })
};
function addHideListSearch() {
    let listRequired = document.getElementById("searchInput");
    listRequired.addEventListener('focusin', (event) => {
        let listRequired = document.getElementById("requiredContainer");
        listRequired.setAttribute('class', 'show-block');
    });
    // listRequired.addEventListener('focusout',(event)=>{
    //     let listRequired=document.getElementById("requiredContainer");
    //     listRequired.setAttribute('class','hidden');
    // });
}

function renderProduct(category, object) {
    let listProducts = controllerFindProduct('', category, '', '');
    let listProductObject = document.getElementsByClassName("right")[0];
    listProductObject.innerHTML = '';
    let HTML = '';
    for (let i = 0; i < listProducts.length; i++) {
        HTML += "<div class='card'><img class='img-card' src='" + listProducts[i].image + "'  /> <div class='card-body'><div class='card-reviews'><i class='ti-star'></i><i class='ti-star'></i><i class='ti-star'></i><i class='ti-star'></i><i class='ti-star'></i><p class='status-review'>review</p></div><div class='card-infor'><span class='infor-name' >" + products[i].name + " " + "</span><span class='infor-price'>" + products[i].price + "</span></div></div></div>";
    }
    listProductObject.innerHTML = HTML;
    let selectedObject = document.getElementsByClassName('title-left')[0];
    let title = document.getElementsByClassName('heading')[0];
    title.innerText = category;
    selectedObject.setAttribute('class', '');
    selectedObject.nextElementSibling.setAttribute('class', 'left-space hidden');
    object.setAttribute('class', 'title-left active');
    object.nextElementSibling.setAttribute('class', 'left-space');
}
function renderProductAndRedirect(category, object, link) {
    window.location = link;
    renderProduct(category, object);
}
function controllerFindProduct(productName, category, minPrice, maxPrice) {
    return findProductByName(productName, findProductByRange(minPrice, maxPrice, findProductBycategory(category)));
}
//arrow funtion

function findProductBycategory(category) {
    if (category != 'All' && typeof category !== 'undefined') {
        let findProduct = [];
        for (let i = 0; i < products.length; i++) {
            if ((products[i].category) === category) {
                findProduct.push(products[i]);
            }
        }
        return findProduct;
    } else {
        return products;
    }
}
function findProductByRange(minPrice, maxPrice, beforeList) {
    let findProduct = [];
    if (typeof minPrice !== 'undefined' && typeof maxPrice !== 'undefined') {
        if (maxPrice == '') {
            maxPrice = 1.7976931348623157e+308;
        }
        if (minPrice == '') {
            minPrice = 0;
        }
        for (let i = 0; i < beforeList.length; i++) {
            if (!(beforeList[i].price).includes('Sold out') && (parseFloat(((beforeList[i].price).split("£")[1]))) >= minPrice && (parseFloat(((beforeList[i].price).split("£")[1]))) <= maxPrice) {
                findProduct.push(beforeList[i]);
            }
        }
        return findProduct;
    } else {
        return beforeList;
    }
}
function findProductByName(productName, beforeList) {
    let findProduct = [];
    if (productName != '') {
        for (let i = 0; i < beforeList.length; i++) {
            if ((beforeList[i].name).includes(productName)) {
                findProduct.push(beforeList[i]);
            }
        }
        return findProduct;
    } else {
        return beforeList;
    }
}
function addCategory() {
    let category = [
        "BRANDS", "Consious Chocolate", "Element for life", "Enjoy", "Forever Cacao", "Ombar"
    ]
    localStorage.setItem("categories", JSON.stringify(category));
}
function showListCategory() {
    let categories = JSON.parse(localStorage.getItem("categories"));
    let categoryList = document.getElementById("categoryList");
    let category = [categories.length];
    for (var i = 0; i < categories.length; i++) {
        category[i] = document.createElement("option");
        category[i].setAttribute("value", categories[i]);
        category[i].innerHTML = categories[i];
        categoryList.appendChild(category[i]);
    }
}
function showListSearch() {
    let listRequired = document.getElementById("requiredContainer");
    listRequired.setAttribute("class", "show-flex");

}
function hideListSearch() {
    let listRequired = document.getElementById("requiredContainer");
    listRequired.setAttribute('class', 'hidden');
}
function redirectUpdateProduct(product){
    localStorage.setItem('redirectAction','updateProduct');
    localStorage.setItem('redirectParameter',JSON.stringify(product.getAttribute("id")));
    window.location="settings.html"
}
